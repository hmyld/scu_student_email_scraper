# scu_student_email_scraper
自动获取您的四川大学学生邮箱最近邮件的脚本
# 四川大学匹兹堡学院邮箱自动化工具
## 1.简介
这是一个基于 Python 和 Playwright 的自动化工具，用于监控四川大学匹兹堡学院（SCUPI）学生邮箱的邮件信息，支持自动登录、邮件信息解析、验证码处理等功能。通过模拟浏览器行为，实现邮箱的自动访问和邮件内容提取，帮助用户便捷地获取邮件信息。不知道这个网站的管理员是怎么想的，非要加个二次验证，给学生添加麻烦，而且网站竟然有反爬！！！也就是说，在保证正常功能运行的前提下，反爬和记录验证码信息只能实现其中一个！这里加了反爬和手动验证，已经极大压缩整个登陆邮箱流程为扫描一个二维码了。
## 2.功能特性
- 自动登录：支持账号密码保存与读取，避免重复输入。程序会读取同目录下的 email.txt 文件获取账号密码，若文件不存在则提示用户输入。
- 邮件解析：实时抓取邮箱中的邮件信息，提取发件人、标题、摘要、收件时间等内容，并支持屏蔽来自 admin 的信息。
- 验证码处理：当遇到需要验证的情况时，程序会自动截取当前页面生成 vc.jpeg 图片，提示用户扫描二维码完成验证。
- 随机 User - Agent：每次运行时从预设的 User - Agent 列表中随机选择一个，模拟不同的浏览器环境，降低被识别为自动化程序的风险。
- 浏览器配置：禁用 AutomationControlled 功能，修改 navigator.webdriver 等属性，模拟真实用户行为。
## 3.环境要求
- Python 版本：3.8+ ，原生Python环境为 3.11.11
- 依赖库：
playwright：用于浏览器自动化操作。
浏览器驱动：Playwright 支持的 Chromium 内核浏览器（安装 Playwright 时会自动下载）。
## 安装步骤
下载本项目的 Python 代码文件（scu_email_spider.py）。
安装依赖库：
```bash
pip install playwright
python -m playwright install chromium  # 安装 Chromium 驱动
```
## 4.使用说明
- 首次运行：
```bash
python your_script_name.py  # 替换为实际的代码文件名
```
根据提示输入邮箱账号密码：
```plaintext
请输入账号：your_username
请输入密码：your_password
是否保存密码? (y/n)：y  # 可选，保存后下次自动读取
```
程序将自动打开 Chromium 浏览器并登录邮箱。若登录过程中需要验证，会在当前目录生成 vc.jpeg 图片，提示用户扫描二维码。
- 后续运行：
直接执行脚本，若已保存密码则自动登录；如需修改密码，删除或修改同目录下的 email.txt 文件后重新运行即可。
邮件信息查看：
登录成功后，程序会自动进入收件箱页面。根据提示选择是否屏蔽来自 admin 的信息：
输入 y：只显示非 admin 发送的邮件。
输入 n：显示所有邮件。
邮件信息将按以下格式输出：
```plaintext
-----------------------------------------------------------------------------------------------------------------------------
发件人：xxx
标题：xxx

摘要：xxx

收件时间：xxx

-----------------------------------------------------------------------------------------------------------------------------
```
## 5.代码结构说明
- 核心函数：
```
open_page()：主函数，负责初始化浏览器、设置浏览器参数、处理登录流程和邮件信息展示。
login(page)：处理登录操作，从文件读取或用户输入获取账号密码，并模拟键盘输入完成登录。
handle_verification_code(page)：处理验证码验证，截取当前页面生成图片。
usr_ipt()：获取用户输入的账号密码，并提供保存功能。
load_credentials()：读取保存的账号密码。
scupian_connection_to_emali(page) 和 connection_to_emali(page)：分别处理屏蔽和不屏蔽 admin 信息的邮件解析逻辑。
```
- 关键文件：
```
scu_email_spider.py（主程序入口）：包含主要的业务逻辑和函数调用。
email.txt：保存账号密码（可选，明文存储，注意安全）。
```
## 6.注意事项
- 密码安全：email.txt 为明文存储，建议仅在个人设备使用，敏感环境请勿保存密码。
- 页面兼容性：邮件解析依赖邮箱页面的 HTML 结构，若邮箱平台更新导致标签变化，可能需要修改代码中相关的选择器（如 tr.j-mail、span.fromto.j-fromto 等）。
- 网络与验证：若登录过程中出现网络问题或验证失败，程序会给出相应提示，请检查网络连接、用户信息或验证码信息。
- IP封禁风险：代码测试过程中共封禁一个IP，不保证此网站反爬机制不会更新，有封禁邮箱的风险。
## 7.贡献与反馈
  - **问题反馈**：如需报告 bug 或提出建议，请在GitHub Issues提交。
  - **代码贡献**：欢迎提交 PR 优化代码，建议先创建 Issue 讨论方案。
  - **支持作者**：用 QQ 1454988406 联系作者，如果您能赏给作者一瓶百事可乐，作者会很开心，并有继续改进代码的动力。
  - **开发者**：Ose Chen - SCUPI
  - **邮箱**：1454988406@qq.com
  - **项目地址**：GitHub [仓库链接](https://github.com/hmyld/scu_student_email_spider)
